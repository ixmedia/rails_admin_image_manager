<%= javascript_include_tag 'rails_admin_image_manager/base' %>

<%= form.send field.view_helper, field.method_name, field.html_attributes.merge({style: (field.editor_options[:hidden_input]==true ? "visibility:hidden;position:absolute" : "")}) %>

<%= link_to t('admin.image_manager_picker.browse').capitalize, RailsAdminImageManager.editor[:imageManagerBrowserUrl], class: "btn create" %>

<%= image_tag field.preview_image_path, style: "padding: 10px 0; display: block;" %>

<% if field.value.present? && !form.object.class.managed_file_is_mandatory?(field.method_name) %>
  <a class="btn btn-info" data-toggle="button" href="#" onclick="$(this).siblings('[type=checkbox]').click(); $(this).siblings('.toggle').toggle('slow'); jQuery(this).toggleClass('btn-danger btn-info'); return false">
    <i class="icon-white icon-trash"></i>
    <%= t('admin.image_manager_picker.deselect') %>
  </a>
  <%= form.check_box field.delete_method, style: 'display:none;' %>
<% end %>

<%= javascript_tag do %>
  $(function(){
    $('#<%=form.dom_id(field)%>_field a').click(function(e){ e.preventDefault(); assetPicker.showFinder('#<%=form.dom_id(field)%>', <%=field.editor_options.to_json.html_safe%>, <%= field.value.to_i %>)})
  })
<% end %>
